# Техническое задание ТЗ

Cтруктура ТЗ соответствует принципам IEEE 830 и адаптирована под Agile.

## 1.Введение

На основе собранных требований в файле requirements.md [Технические требования](Documentation/requirements.md) следующий этап разработки - проектирование архитектуры системы.
Составлено Техническое задание ТЗ, в котором описана схема взаимодействия всех компонентов системы, а также задокументированы алгоритмы рекомендаций и API.

## 2. Общие требования

Система рекомендаций контента предназначена для мультимедийной платформы, которая интегрирует несколько типов контента, таких как фильмы, сериалы, ТВ-каналы, спорт-трансляции и мультфильмы. Основной функцией системы является предоставление персонализированных рекомендаций контента на основе поведения пользователей на платформе.

## 3. Архитектура системы

Компоненты архитектуры системы:

1. **Модуль анализа предпочтений пользователей** — отслеживает историю просмотров и оценки пользователей
2. **Модуль рекомендаций** — использует алгоритмы (коллаборативная фильтрация и контентная фильтрация) для генерации рекомендаций
3. **API для интеграции с другими платформами** — получение данных о контенте с ТВ-платформ, спортивных каналов и других источников
4. **Консольный интерфейс** — для отображения рекомендаций и управления фильтрами

## 4. Алгоритм рекомендаций

Методы алгоритма рекомендаций:

### 4.1. **Коллаборативная фильтрация**:

- Использует информацию о предпочтениях пользователей для предложения контента на основе схожих интересов

<details>
<summary>Детали коллаборативной фильтрации:</summary>

#### 4.1.1. **Описание**:

- Коллаборативная фильтрация использует информацию о предпочтениях пользователей для предложения контента на основе схожих интересов. Это может быть полезно, когда у пользователя есть достаточно истории взаимодействий с платформой, и на основе этих данных можно предсказать, что ему понравится.
- Коллаборативная фильтрация — это метод, основанный на анализе поведения пользователей и нахождении схожих интересов между ними. Он использует данные о предыдущих оценках и действиях пользователей для того, чтобы рекомендовать контент, который понравился похожим пользователям.

#### 4.1.2. **Принцип работы**:

- Алгоритм анализирует данные других пользователей, которые имеют схожие интересы
- Рекомендуется контент, который был оценен и просмотрен схожими пользователями
- Подходит для пользователей с богатой историей взаимодействий на платформе

#### 4.1.3. **Метод**:

1. **Сотрудничество пользователей**: Для каждого пользователя анализируются действия других пользователей с схожими интересами и предпочтениями
2. **Матрица пользователь-контент**: Используется матрица, в которой строки представляют пользователей, а столбцы — контент. Ячейки этой матрицы будут содержать оценки или предпочтения пользователей по отношению к различным элементам контента (фильмы или сериалы)
3. **Поиск схожих пользователей**: Применяются алгоритмы для нахождения пользователей с наиболее схожими предпочтениями. Например, с помощью методов косинусного сходства или корреляции Пирсона можно вычислить, насколько сильно похожи два пользователя
4. **Рекомендации на основе схожести**: На основе найденных похожих пользователей система будет рекомендовать контент, который понравился этим пользователям, но еще не был просмотрен текущим пользователем

#### 4.1.4. **Преимущества**:

- Позволяет рекомендовать новый контент, который пользователь может не заметить
- Рекомендуется для случаев, когда у пользователя еще нет большого опыта на платформе

#### 4.1.5. **Ограничения**:

- Может страдать от проблемы **холодного старта**, когда система не имеет достаточного количества данных о новом пользователе
- Проблемы с масштабируемостью и производительностью при большом количестве пользователей
    </details>

### 4.2. **Контентная фильтрация**:

- Рекомендует контент, исходя из жанра и других характеристик (популярность, рейтинг)

<details>
<summary>Детали контентной фильтрации:</summary>

#### 4.2.1. **Описание:**

Контентная фильтрация делает рекомендации, основываясь на характеристиках контента, с которым пользователь уже взаимодействовал. Это может быть жанр, популярность, рейтинг, актеры, режиссеры, год выпуска и другие атрибуты.

#### 4.2.2. **Метод:**

- **Анализ характеристик контента:** Для каждого контента (фильмов, сериалов, ТВ-каналов и т.д.) создаются метки или атрибуты, которые описывают его особенности, например, жанр, рейтинг, ключевые слова и т.д
- **Поиск схожих элементов контента:** Когда пользователь просматривает контент, система ищет другие элементы, которые имеют схожие характеристики, и предлагает их пользователю
- **Рекомендации по схожести контента:** Например, если пользователь часто смотрит фильмы в жанре экшн с высоким рейтингом, система предложит другие экшн-фильмы с хорошими отзывами

#### 4.2.3. **Преимущества:**

- Решает проблему холодного старта, так как даже новый пользователь может получать рекомендации на основе контента, который он просмотрел.
- Рекомендует контент, который точно соответствует интересам пользователя.

#### 4.2.4. **Ограничения:**

- Может не учитывать "неочевидные" предпочтения пользователя (например, интерес к жанрам или темам, которые не были явно выражены в истории просмотров).
  </details>

### 4.3 **Смешанный подход**:

- Комбинированное использование обеих фильтраций для более точных рекомендаций

<details>
<summary>Детали смешанного подхода:</summary>

#### 4.3.1. **Описание:**

Смешанный подход комбинирует элементы коллаборативной и контентной фильтрации для получения более точных рекомендаций. Этот подход позволяет избежать ограничений каждого метода и предоставляет более персонализированные рекомендации.

#### 4.3.2. **Метод:**

- **Интеграция коллаборативной и контентной фильтрации:** Система будет использовать обе фильтрации одновременно и комбинировать их результаты для формирования окончательной рекомендации. Например, сначала могут быть получены рекомендации по контентной фильтрации, а затем фильтры коллаборативной фильтрации будут использоваться для уточнения предложений
- **Взвешенные рекомендации:** Для каждой рекомендации будет вычисляться вес, который будет учитывать важность каждого из методов (например, если коллаборативная фильтрация дает более релевантные результаты для пользователя, то ее рекомендации получат больший вес).

#### 4.3.3. **Преимущества:**

- Устраняет ограничения коллаборативной и контентной фильтрации по отдельности
- Предоставляет более точные и персонализированные рекомендации

#### 4.3.4. **Ограничения:**

- Требует больше вычислительных ресурсов для обработки и комбинации результатов
- Необходимость в сложной настройке для оптимизации веса методов
  </details>

### 4.4 **Применение алгоритма**:

- Рекомендации генерируются путем выполнения алгоритмов в зависимости от данных о пользователе и контексте

  - **Для нового пользователя** (без истории действий) применяется **контентная фильтрация**, основываясь на жанрах и характеристиках контента
  - **Для активных пользователей**, у которых есть история просмотров, применяется **коллаборативная фильтрация**, чтобы рекомендовать контент, который понравился похожим пользователям
  - **Смешанный подход** применяется, когда необходимо объединить результаты обоих методов для повышения точности

- **Выборочное применение (основной подход)**: проще для начала, более гибкое, позволяет быстро адаптировать систему к пользовательскому контексту
- **Последовательное применение (смешанный подход)**: более сложный, но может дать более точные рекомендации в большинстве случаев, поскольку комбинируются лучшие качества двух методов

### 4.5 **Пример реализации алгоритма**:

**Пример запроса:** Чтобы получить рекомендации, система может делать запросы к базе данных или API с учетом следующих параметров:

```http
GET /api/v1/recommendations?user_id=123&method=collaborative
GET /api/v1/recommendations?user_id=123&method=content
GET /api/v1/recommendations?user_id=123&method=mixed
```

Где:

- `user_id` — ID пользователя для получения персонализированных рекомендаций
- `method` — метод фильтрации (коллаборативный, контентный или смешанный)

## 5. Взаимодействие с API

Система взаимодействует с внешними API для получения данных о контенте: cписок фильмов, сериалов, ТВ-каналов и спортивных трансляций.
Система использует несколько API для получения информации о контенте.

### 5.1. **API для фильмов и сериалов**:

- Позволяет получать данные о названиях, жанрах, описаниях, рейтингах, годах выпуска

<details>
<summary>Детали API для фильмов и сериалов:</summary>

#### 5.1.1. **Поставщик:**

- [TMDb (The Movie Database) API](https://www.themoviedb.org/documentation/api)

#### 5.1.2. **Данные:**

- Название
- Жанры
- Описание
- Рейтинг
- Год выпуска
- Актерский состав

#### 5.1.3. **Аутентификация:**

- Для доступа используется API-ключ, который предоставляется в каждом запросе. Для доступа необходимо зарегистрироваться на платформе и получить уникальный ключ.

#### 5.1.4. **Частота обновлений:**

- Данные о контенте, популярных фильмах и сериалах обновляются ежедневно 1 раз в сутки. Используется RESTful API, запросы могут быть отправлены через HTTP GET-запросы.

#### 5.1.5. **Методы запроса:**

- Пример запроса для получения списка популярных фильмов:

```http
GET https://api.themoviedb.org/3/movie/popular?api_key=your_api_key&language=ru-RU
```

#### 5.1.6. **Ограничения:**

- API позволяет делать до 40 запросов в минуту для каждого ключа. Для обеспечения стабильности системы реализовано кеширование запросов.
</details>

### 5.2. **API для ТВ-каналов:**

- Для получения данных о ТВ-каналах и расписаниях трансляций используется API, предоставляющее информацию о текущих и предстоящих трансляциях.

<details>
<summary>Детали API для ТВ-каналов:</summary>

#### 5.2.1. **Поставщик:**

- [TVMaze API](https://www.tvmaze.com/api)

#### 5.2.2. **Данные:**

- Список каналов
- Расписания трансляций
- Жанры программ

#### 5.2.3. **Аутентификация:**

- Не требует аутентификации, доступно через открытый API. Для доступа используется API-ключ.

#### 5.2.4. **Частота обновлений:**

- Данные о расписании обновляются каждую минуту, так как расписания трансляций могут изменяться.

#### 5.2.5. **Методы запроса:**

- Пример запроса для получения информации о текущих трансляциях:

```http
GET https://api.tvmaze.com/schedules?country=US&date=2025-03-01
```

#### 5.2.6. **Ограничения:**

- В случае высокой нагрузки или изменений расписаний, API может быть недоступным. Будет реализована обработка ошибок и уведомления пользователей. Если данные не могут быть получены (например, из-за недоступности API), система будет использовать последние доступные данные из кэша.
</details>

### 5.3. **API для спортивных событий:**

- Для получения данных о спортивных событиях и трансляциях используется API, предоставляющее информацию о матчах, турнирах, командах и результатах.

<details>
<summary>Детали API для спортивных событий:</summary>

#### 5.3.1. **Поставщик:**

- [SportRadar API](https://sportradar.com/media-tech/data-content/sports-data-api/)

#### 5.3.2. **Данные:**

- Расписание спортивных событий
- Информация о командах и турнирах

#### 5.3.3. **Аутентификация:**

- API требует ключа доступа для каждого запроса, который предоставляется при регистрации. Для доступа используется OAuth 2.0 для авторизации.

#### 5.3.4. **Частота обновлений:**

- Информация о матчах и трансляциях обновляется в реальном времени.

#### 5.3.5. **Методы запроса:**

- Пример запроса для получения информации о спортивном событии::

```http
GET https://api.sportradar.us/sports-api/v1/events?api_key=your_api_key
```

#### 5.3.6. **Ограничения:**

- Максимум 100 запросов в минуту для каждого API-ключа.
</details>

- Рейтинги и отзывы пользователей
- Информация о новинках и расписаниях (для ТВ-каналов и спортивных событий)

API должно обеспечивать:

- Стандартные запросы для получения контента
- Обновление данных в реальном времени для обеспечения актуальности рекомендаций

Пример запроса:

```http
GET /api/v1/movies?genre=action&rating=8.0
```

## 6. Технические детали

### 6.1. База данных

Для хранения данных используется реляционная база данных (PostgreSQL), которая хранит:

- Информацию о пользователях
- Данные о контенте (фильмы, сериалы, спорт-трансляции, ТВ-контент, мультфильмы)
- Историю просмотров и оценки пользователей

### 6.2. Алгоритм рекомендаций

Механизм работы алгоритма рекомендаций:

1. Система анализирует данные о действиях пользователя
2. Применяется коллаборативная фильтрация для нахождения похожих пользователей
3. Используется контентная фильтрация для уточнения рекомендаций
4. Рекомендации сортируются и выводятся в консоль

### 6.3. Безопасность и защита данных

Система должна обеспечивать защиту персональных данных пользователей, включая:

- Шифрование данных (с использованием SSL/TLS)
- Аутентификацию и авторизацию через (OAuth)
- Соблюдение законодательства о защите данных (GDPR)

## 7. **User Stories**

Для обеспечения ясности требований и фокусировки на пользователе, представлены ключевые **User Stories**, которые описывают, как пользователи будут взаимодействовать с системой рекомендаций:

### 7.1. Получение персонализированных рекомендаций

<details>
<summary>Как пользователь, я хочу получать персонализированные рекомендации</summary>

**Как пользователь**, я хочу получать персонализированные рекомендации, чтобы легко находить контент, соответствующий моим интересам.

- **Acceptance Criteria**:
  - Система отслеживает историю просмотров и предпочтения пользователя
  - На основе этих данных генерируются персонализированные рекомендации

</details>

---

### 7.2. Фильтрация контента по жанрам

<details>
<summary>Как пользователь, я хочу фильтровать контент по жанрам</summary>

**Как пользователь**, я хочу фильтровать контент по жанрам, чтобы видеть только те фильмы и программы, которые мне интересны.

- **Acceptance Criteria**:
  - В интерфейсе есть возможность фильтровать контент по жанрам (драма, экшн, фантастика и т.д.)
  - Рекомендации отображаются в соответствии с выбранным фильтром

</details>

---

### 7.3. Сортировка контента по рейтингу

<details>
<summary>Как пользователь, я хочу сортировать контент по рейтингу</summary>

**Как пользователь**, я хочу сортировать контент по рейтингу, чтобы увидеть лучшие фильмы и шоу.

- **Acceptance Criteria**:
  - В интерфейсе имеется опция сортировки контента по рейтингу (топ-10)
  - Пользователь может выбрать сортировку по популярности или рейтингу

</details>

---

### 7.4. Получение рекомендаций в реальном времени

<details>
<summary>Как пользователь, я хочу получать рекомендации в реальном времени</summary>

**Как пользователь**, я хочу получать рекомендации в реальном времени, чтобы всегда видеть актуальные предложения.

- **Acceptance Criteria**:
  - Рекомендации обновляются при изменении истории просмотров или оценок
  - Пользователь получает актуальные рекомендации в течение нескольких секунд

</details>

---

### 7.5. Фильтрация контента по новизне

<details>
<summary>Как пользователь, я хочу фильтровать контент по новизне</summary>

**Как пользователь**, я хочу фильтровать контент по новизне, чтобы смотреть только новые фильмы или сериалы.

- **Acceptance Criteria**:
  - Возможность фильтровать контент по дате выхода (новинки, свежие выпуски)
  - Отображение только контента, который был выпущен недавно

</details>

---

### 7.6. Рекомендации на основе схожих интересов других пользователей

<details>
<summary>Как пользователь, я хочу, чтобы система рекомендовала мне контент на основе схожих интересов других пользователей</summary>

**Как пользователь**, я хочу, чтобы система рекомендовала мне контент на основе схожих интересов других пользователей, чтобы находить новое и интересное.

- **Acceptance Criteria**:
  - Система анализирует действия других пользователей с похожими интересами и предлагает схожие рекомендации

</details>

---

## 8. Тестирование

### 8.1. Модульное тестирование

Для каждого компонента системы разработано модульное тестирование с использованием фреймворка для юнит-тестов (NUnit), что обеспечивает корректную работу системы.

### 8.2. Интеграционное тестирование

Планируется проведение интеграционных тестов для проверки правильности взаимодействия компонентов системы (взаимодействие с API и получение рекомендаций).

## 9. Заключение

Данное техническое задание ТЗ является основой для реализации системы рекомендаций контента. В рамках проекта применены методы анализа предпочтений пользователей, фильтрации контента и использование внешних API для интеграции с другими платформами (мобильными приложениями, ТВ-платформами). Система должна обеспечивать высокую производительность, масштабируемость и устойчивость к сбоям, обеспечивая при этом качественный пользовательский опыт.
